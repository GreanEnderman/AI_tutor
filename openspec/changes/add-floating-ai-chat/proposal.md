# 添加悬浮AI对话球功能 - 提案

## Why

用户在使用知识库功能时经常遇到以下痛点：
1. **上下文切换成本高** - 当用户在阅读或编辑笔记时，需要切换到专门的对话页面才能获得AI帮助，打断了学习流程
2. **缺乏智能建议** - 现有的对话功能无法感知当前页面内容，用户需要手动描述上下文才能获得相关帮助
3. **学习体验不连贯** - 在笔记编辑或阅读过程中，无法快速获得相关的AI辅导建议，影响学习效率

通过在base界面添加悬浮AI对话球，可以：
- 提供无需切换页面的即时AI访问
- 基于当前页面内容提供智能化的上下文感知对话
- 根据不同视图（笔记阅读、编辑等）提供场景化的推荐提问
- 保持现有功能完整性的同时增强用户体验

## What Changes

### 核心功能添加
1. **悬浮球组件** - 在base页面右下角添加固定的圆形悬浮按钮
2. **AI对话小窗** - 点击悬浮球弹出的小型对话窗口，支持完整的AI对话功能
3. **上下文感知模块** - 能够读取和分析当前页面内容，为AI提供上下文
4. **智能推荐系统** - 根据当前视图类型提供场景化的推荐问题

### 现有功能扩展
1. **GLMTutor类扩展** - 添加小窗模式支持，复用现有API调用逻辑
2. **页面布局调整** - 为悬浮组件预留合适的显示空间
3. **样式系统扩展** - 新增悬浮组件相关的CSS样式

## Impact

### 用户体验影响
- **正面影响**:
  - 减少页面切换，提供更流畅的学习体验
  - 基于上下文的智能对话，提高学习效率
  - 随时随地的AI辅导支持
- **潜在风险**:
  - 可能对部分用户造成界面干扰
  - 学习习惯的短期适应期

### 技术影响
- **代码复杂度**: 增加前端组件复杂度，但通过模块化设计保持可维护性
- **性能影响**: 轻微增加页面加载时间，通过优化控制在可接受范围内
- **兼容性**: 与现有功能完全兼容，不会破坏现有用户体验

### 开发影响
- **工作量**: 中等规模的新功能开发，预计2-3周完成
- **维护成本**: 需要持续的维护和优化
- **扩展性**: 为未来更多上下文感知功能奠定基础

## 概述

在base界面的右下角添加一个悬浮球，点击后可以小窗形式打开AI对话功能。该AI对话功能能够读取当前页面内容，并提供智能的推荐提问。根据不同视图（笔记阅读、笔记编辑等）提供相应的上下文感知对话。

## 需求背景

用户在使用知识库功能时，希望能够：
1. 快速访问AI对话功能，无需切换到专门的对话页面
2. 获得基于当前页面内容的智能对话体验
3. 在笔记编辑或阅读时获得相关的AI帮助

## 解决方案

### 核心功能
1. **悬浮球组件** - 固定在页面右下角的圆形按钮
2. **AI对话小窗** - 点击悬浮球后弹出的小型对话窗口
3. **上下文感知** - AI能够读取当前页面内容并提供相关建议
4. **推荐提问** - 根据当前视图提供智能化的推荐问题

### 技术实现
- 复用现有的GLM4.5 API调用逻辑
- 扩展现有的GLMTutor类以支持小窗模式
- 新增悬浮球UI组件和相关样式
- 实现页面内容读取和上下文分析功能

## 用户故事

### 作为知识库用户
- **场景1 (笔记阅读)**: 当我正在阅读笔记时，我希望能够快速询问AI关于这个笔记内容的问题，比如"总结一下笔记内容"
- **场景2 (笔记编辑)**: 当我正在编辑笔记时，我希望AI能够帮助我优化内容，比如"优化一下笔记排版"或"帮我写成一篇会议纪要"
- **场景3 (通用功能)**: 我希望在任何界面都能快速访问AI对话功能，同时保持与其他功能的兼容性

## 设计考虑

### UI/UX
- 悬浮球设计需与现有界面风格保持一致
- 小窗对话界面应简洁但功能完整
- 需要支持拖拽、最小化等交互
- 响应式设计，适配不同屏幕尺寸

### 技术考虑
- 需要确保不影响现有功能的正常运行
- 小窗模式的性能优化
- 内容上下文的安全性和隐私保护
- API调用的合理频率控制

## 验收标准

1. 悬浮球正确显示在base界面右下角
2. 点击悬浮球能够打开AI对话小窗
3. AI能够读取并理解当前页面内容
4. 根据不同视图提供准确的推荐提问
5. 对话功能与现有index页面的功能保持一致
6. 界面设计风格与页面主体保持一致
7. 所有现有功能正常运行不受影响